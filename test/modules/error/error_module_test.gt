#include "cspec.h"
#include "cspec_output_header.h"
#include "cspec_output_verbose.h"
#include "cspec_output_unit.h"
#include "modules/error.h"

extern int status;
extern error_module ErrorModule;

DESCRIBE(error_module_initialize, "Error Module - initialize")
  IT("sets the initialized property to TRUE")
    ErrorModule.initialize(&ErrorModule);

    SHOULD_BE_TRUE(ErrorModule.initialized)
  END_IT

  IT("sets the error list size")
    SHOULD_BE_TRUE(ErrorModule.error_list_size);
  END_IT

  IT("registers a list of error messages")
    for (int i = 0; i < ErrorModule.error_list_size; i++) {
      SHOULD_NOT_BE_NULL(ErrorModule.messages[i]);
    }
  END_IT
END_DESCRIBE

DESCRIBE(error_module, "Error Module")
	IT("is present")
    SHOULD_NOT_BE_NULL(&ErrorModule)
	END_IT

  IT("is not initialized")
    SHOULD_BE_FALSE(ErrorModule.initialized)
  END_IT

  status += CSpec_Run( DESCRIPTION( error_module_initialize ), CSpec_NewOutputVerbose() );

END_DESCRIBE